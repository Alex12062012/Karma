<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karma - Casino</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="login-page">
    <div class="login-container">
        <div class="login-box">
            <div class="logo">
                <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                    <circle cx="20" cy="20" r="18" fill="url(#karma-gradient)" opacity="0.2"/>
                    <path d="M20 4C20 4 12 12 12 20C12 24 14 28 20 28C26 28 28 24 28 20C28 12 20 4 20 4Z" fill="url(#karma-gradient)"/>
                    <circle cx="20" cy="16" r="3" fill="white"/>
                    <path d="M16 22C16 22 18 24 20 24C22 24 24 22 24 22" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    <defs>
                        <linearGradient id="karma-gradient" x1="20" y1="4" x2="20" y2="36" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#9333EA"/>
                            <stop offset="0.5" stop-color="#EC4899"/>
                            <stop offset="1" stop-color="#F59E0B"/>
                        </linearGradient>
                    </defs>
                </svg>
                <h1>Karma</h1>
            </div>
            
            <div class="tab-container">
                <button class="tab-btn active" data-tab="login">Connexion</button>
                <button class="tab-btn" data-tab="register">Inscription</button>
            </div>
            
            <div class="tab-content active" id="login-tab">
                <form id="login-form">
                    <div class="form-group">
                        <label>Nom d'utilisateur</label>
                        <input type="text" name="username" required placeholder="Entrez votre nom d'utilisateur">
                    </div>
                    <div class="form-group">
                        <label>Mot de passe</label>
                        <input type="password" name="password" required placeholder="Entrez votre mot de passe">
                    </div>
                    <button type="submit" class="btn-primary">Se connecter</button>
                </form>
            </div>
            
            <div class="tab-content" id="register-tab">
                <form id="register-form">
                    <div class="form-group">
                        <label>Nom d'utilisateur</label>
                        <input type="text" name="username" required placeholder="Choisissez un nom d'utilisateur">
                    </div>
                    <div class="form-group">
                        <label>Mot de passe</label>
                        <input type="password" name="password" required placeholder="Choisissez un mot de passe">
                    </div>
                    <div class="bonus-info">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 0L12.2451 6.90983H19.5106L13.6327 11.1803L15.8779 18.0902L10 13.8197L4.12215 18.0902L6.36729 11.1803L0.489435 6.90983H7.75486L10 0Z" fill="#00D9A3"/>
                        </svg>
                        <span>Bonus de bienvenue : 1000€</span>
                    </div>
                    <button type="submit" class="btn-primary">Créer un compte</button>
                </form>
            </div>
            
            <div class="error-message" id="error-message"></div>
        </div>
        
        <div class="background-effects">
            <div class="gradient-orb orb-1"></div>
            <div class="gradient-orb orb-2"></div>
            <div class="gradient-orb orb-3"></div>
        </div>
    </div>
    
    <script>
        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab + '-tab').classList.add('active');
                
                document.getElementById('error-message').textContent = '';
            });
        });
        
        // Login form
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            try {
                const response = await fetch('/login', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        username: formData.get('username'),
                        password: formData.get('password')
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    window.location.href = '/casino';
                } else {
                    document.getElementById('error-message').textContent = data.message;
                }
            } catch (error) {
                document.getElementById('error-message').textContent = 'Erreur de connexion';
            }
        });
        
        // Register form
        document.getElementById('register-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            try {
                const response = await fetch('/register', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        username: formData.get('username'),
                        password: formData.get('password')
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    window.location.href = '/casino';
                } else {
                    document.getElementById('error-message').textContent = data.message;
                }
            } catch (error) {
                document.getElementById('error-message').textContent = 'Erreur d\'inscription';
            }
        });
    </script>
</body>
</html>
